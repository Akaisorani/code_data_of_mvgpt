import json
import time
import requests



# env = app.config.from_prefixed_env()

default_env = 'prepub'
host_env_dict = {'prepub': 'pre-jdbc-cn-zhangbei.dolphin.XXX.com',
                 'publish': 'jdbc-cn-zhangbei.dolphin.XXX.com'}

def get_kr_info(adgroup_id):
    sql = 'select title,cate_full_id from new_XXX.XXX_kgb_cmop_p4p_cmop_n_nopass_ad_setting_market_clkpv_hh WHERE adgroup_id = {};'

    result = execute_dolphin_sql(sql.format(adgroup_id))
    data = result[0]
    title = data[0]
    cate_full_id = data[1]
    cate_list = cate_full_id.split(' ')
    return title, cate_list

def execute_dolphin_model_sql(sql):
    start_time = time.time()
    print("start execute dolphin sql: " + sql.replace('\n', ' '))
    params = {"dbType": "dolphin", "sql": sql}
    headers = {"accessId": "Opww15ZTCgjc6EyL", "accessKey": "PxDD5zYeXyNak7qZbvfsF1e32qZTCgjc"}

    response = requests.post("http://" + 'model-jdbc-cn-zhangbei.dolphin.XXX.com' + "/api/tasks/insight", data=params, headers=headers)
    # response = requests.post("http://" + 'pre-jdbc-cn-zhangbei.dolphin.XXX.com' + "/api/tasks/insight", data=params, headers=headers)
    print("execute dolphin sql cost " + str(time.time() - start_time))
    if response.status_code != 200:
        err_msg = "call dolphin error, status code is " + str(response.status_code)
        print(err_msg)
        raise Exception(err_msg)
    json_entity = json.loads(response.text)
    if not json_entity['success']:
        err_msg = "call dolphin error, error message " + json_entity['message']
        print(err_msg)
        raise Exception(err_msg)
    # list list结构
    return json_entity['result']

def execute_dolphin_sql(sql):
    start_time = time.time()
    print("start execute dolphin sql: " + sql.replace('\n', ' '))
    params = {"dbType": "dolphin", "sql": sql}
    headers = {"accessId": "K3LmR7ne0MQLyMOV", "accessKey": "054WHnUaeWAKyLqltLBFanyatea2TQnw"}

    response = requests.post("http://" + 'jdbc-cn-zhangbei.dolphin.XXX.com' + "/api/tasks/insight", data=params, headers=headers)
    print("execute dolphin sql cost " + str(time.time() - start_time))
    if response.status_code != 200:
        err_msg = "call dolphin error, status code is " + str(response.status_code)
        print(err_msg)
        raise Exception(err_msg)
    json_entity = json.loads(response.text)
    if not json_entity['success']:
        err_msg = "call dolphin error, error message " + json_entity['message']
        print(err_msg)
        raise Exception(err_msg)
    # list list结构
    return json_entity['result']


if __name__ == '__main__':
    # resp = '{"context":{"queryExecutorContext-1":{"finalDbId":"greenplum_alimm_dolphin_cloud"},"dimInfo":["value"]},"errorCode":"","message":"fusionEngine queryId is fusion-query-eae91ce4-8c5f-4b2f-81eb-0adcefb55e78,json message:【{\\"cost-analyze\\":0.143963,\\"matchedGroupInfo\\":[],\\"cost-optimize-DeDuplicateProjectionOptimizer\\":0.034365,\\"cost-optimize-UnwrapIdentifyOptimizer\\":0.010907,\\"cost-optimize-DoplinFilterPushDownToTsOptimizer\\":0.002945,\\"cost-optimize-JoinToUnionOptimizer\\":0.004055,\\"cost-total\\":81.311136,\\"toSqlId1\\":\\"select count\\u0028distinct dolphin_materialized_view_new_XXX.__aid\\u0029 as _0\\\\nfrom \\\\nnew_XXX.dolphin_materialized_view_new_XXX as subquery_3 where dolphin_materialized_view_new_XXX.materialized_id in \\u0028\\\\u0027tag_id_210788\\\\u0027\\u0029\\",\\"matchedMaterializeIndex\\":[],\\"queryId\\":\\"fusion-query-eae91ce4-8c5f-4b2f-81eb-0adcefb55e78\\",\\"cost-optimize-RemoveUnusedColOptimizer\\":0.154851,\\"cost-logicPlan\\":0.120836,\\"cost-executor-QueryExecutor-1\\":79.002181,\\"cost-executionPlan\\":0.0139,\\"cost-optimize-MaterializeOptimizer\\":1.379051,\\"cost-optimize-FilterSortOptimizer\\":0.012099,\\"cost-optimize\\":1.649701,\\"cost-parse\\":0.258331,\\"cost-optimize-TableScanEngineOptimizer\\":0.003506,\\"cost-optimize-PlanRefsOptimizer\\":0.002602,\\"cost-physicalPlan\\":0.082389}】|sqlMaterializeActionRun| this query would be cached by materialize-lib, hash id is dolphin_materialize_part_prod_03_ce3fb885683225560030994ac60a05e5_binary_cache_2","result":[[34366709]],"success":true}'
    # resp_json = json.loads(resp)
    # print(resp_json)
    #
    # sql = 'SELECT title,cate_full_id from new_XXX.XXX_kgb_cmop_p4p_cmop_n_nopass_ad_setting_market_clkpv_hh WHERE adgroup_id = 4310156998;'
    # result = execute_dolphin_sql(sql)
    # data = result[0]
    # title = data[0]
    # cate_full_id = data[1]
    # cate_list = cate_full_id.split(' ')
    # print(cate_list)

    sql = """/*direct_sql=true,biz_key=kgb_kr_emb*/
SELECT  id
        ,pm_approx_euclidean_distance(
            embedding
            ,CAST(
                ARRAY[-0.22023507952690125,0.5245894193649292,-0.6863569021224976,-0.21666982769966125,1.314552903175354,-0.3000071942806244,-0.25955572724342346,-0.006581411696970463,-1.180133581161499,-1.7503087520599365,0.11765094101428986,-1.1104555130004883,1.0510356426239014,-0.04908008873462677,-0.36354556679725647,-0.47514432668685913,0.6993897557258606,0.1442989856004715,-0.5219874382019043,1.2096645832061768,-0.40954652428627014,-0.5166781544685364,0.047100216150283813,0.029874801635742188,-0.4642573893070221,-2.015850067138672,0.7668883800506592,1.2987215518951416,-2.3366832733154297,-0.206565722823143,0.17397697269916534,-0.728667140007019,0.2371368706226349,0.007608566898852587,0.9372339844703674,-1.3845082521438599,-0.08280597627162933,-0.3468315899372101,-1.5054352283477783,0.8715206980705261,1.1621949672698975,0.0013946351828053594,0.1688745766878128,-0.25983062386512756,0.7945474982261658,0.6908787488937378,0.8755765557289124,0.21050521731376648,-0.028318002820014954,-0.08972623944282532,-0.6541533470153809,-1.073602557182312,0.2693215012550354,-0.6444795727729797,-0.41360458731651306,0.5105670690536499,0.48965582251548767,1.3511228561401367,0.4770185351371765,1.1180812120437622,-0.16773000359535217,2.8572680950164795,-0.49995332956314087,1.6262904405593872,0.4750995635986328,0.43278563022613525,-0.627718448638916,-1.7035588026046753,0.5525071024894714,0.4523337185382843,-0.32347720861434937,1.669956922531128,-0.1081455647945404,1.3648284673690796,-0.16055986285209656,1.0777108669281006,-1.0727057456970215,0.5012142658233643,0.41729459166526794,0.5255684852600098,0.6419657468795776,0.8964436650276184,-0.033858176320791245,0.6232964396476746,1.98687744140625,0.6573908925056458,-0.7284037470817566,4.962974548339844,-0.4543198049068451,0.7161107659339905,0.7974088788032532,0.20337504148483276,0.6972523927688599,0.07918130606412888,0.6979421973228455,0.09216997772455215,-0.3387763202190399,0.9326569437980652,1.0087591409683228,0.6657720804214478,-1.112622857093811,0.3288540840148926,0.2817796468734741,0.5923953652381897,-0.4013511538505554,0.3950779438018799,-0.18126901984214783,-0.03616870194673538,0.7346392869949341,-0.8166136741638184,0.2388966828584671,-0.4702090322971344,0.3769724369049072,1.7813904285430908,-1.035346269607544,0.2696020007133484,-0.5173664093017578,-0.8954277038574219,-1.064247727394104,1.5499483346939087,-0.7366779446601868,-0.4463615417480469,-0.4716605246067047,-0.09640396386384964,0.49968215823173523,0.32168763875961304,-0.16022732853889465,0.030078671872615814,-0.011823256500065327,-0.2584657073020935,0.3015134334564209,-0.389511376619339,1.82564377784729,0.12237507849931717,1.1357908248901367,0.3860599100589752,0.11493834108114243,-0.608435332775116,-0.3286566734313965,0.295664519071579,0.06474386155605316,0.2595694363117218,0.02705661952495575,-0.004162135533988476,0.08943599462509155,-0.07040904462337494,0.04060346633195877,-0.20412904024124146,0.026074929162859917,-0.8226591944694519,1.059815764427185,-0.9013573527336121,-1.3925572633743286,-0.9757871031761169,-0.23246081173419952,-0.4649428427219391,1.1275455951690674,-0.42838141322135925,-0.09275277704000473,-1.8488863706588745,-0.2533354163169861,0.02295147441327572,-0.18616940081119537,-0.4141623079776764,1.50121009349823,0.438771516084671,-0.9075409770011902,0.1540689915418625,2.0468592643737793,0.9534556865692139,-0.45263010263442993,0.7434648871421814,0.07887521386146545,0.38948673009872437,-0.9330243468284607,-0.6326560974121094,-0.7460736036300659,-0.7064235806465149,0.455971896648407,0.7514253258705139,0.4543333649635315,-2.097635269165039,0.23700203001499176,-0.7313745617866516,-0.8263869285583496,0.38238298892974854,1.0762883424758911,-0.42836079001426697,-0.6602190732955933,-0.06385365128517151,0.1876928061246872,0.9447595477104187,0.02025746926665306,0.650877833366394,0.611443817615509,0.6421546936035156,-0.4194657802581787,-1.1155105829238892,-0.3312533497810364,0.5800778865814209,0.2110482156276703,0.6799124479293823,-0.3402523696422577,1.0512834787368774,-0.15441271662712097,0.24945709109306335,-0.6921469569206238,0.19535104930400848,0.5842195749282837,0.2790238559246063,-1.5442134141921997,-0.8296940922737122,0.9708586931228638,0.039348501712083817,0.7812884449958801,0.18767230212688446,0.0639088824391365,0.33800607919692993,1.2739964723587036,0.006772168911993504,-0.9616801142692566,-1.042738676071167,0.16041553020477295,0.13039669394493103,1.172650933265686,-0.33394312858581543,0.1458526849746704,0.25221696496009827,-1.08505117893219,-1.2406625747680664,-0.1966049075126648,0.37590405344963074,0.20189730823040009,-0.8440850377082825,-0.4753663241863251,-1.2663136720657349,0.38851696252822876,0.9705585241317749,-0.866628110408783,-0.029663696885108948,0.522980809211731,-0.8004772663116455,-1.1715478897094727,-0.2750479280948639,1.1949427127838135,1.202843427658081,-0.2720370292663574,-1.2014620304107666,-0.42317670583724976,0.11759861558675766,-0.888952910900116,0.9955486059188843,0.5571152567863464,-1.2955538034439087,-0.33207637071609497,0.27416443824768066,0.6815133094787598,0.5714060664176941,0.4453057646751404,-0.2215530127286911,1.2536081075668335,-0.8389703631401062,-0.24240455031394958,-0.20806638896465302,0.3049972653388977,1.2965635061264038,0.16737006604671478,1.436659336090088,0.823625922203064,0.9965925812721252,-0.24603670835494995,0.51707923412323,-1.39162278175354,0.3196340501308441,-0.20294445753097534,0.8769529461860657,-1.4752089977264404,0.41623860597610474,-0.1191352903842926,0.7867650389671326,0.8357526063919067,-0.21534498035907745,0.8572604656219482,0.1493605226278305,0.7538349628448486,-0.7684805989265442,0.07943760603666306,0.6643137335777283,1.1202406883239746,-0.10811150819063187,-0.35495525598526,-0.6043872833251953,0.3581241965293884,-0.5066404938697815,0.9014880061149597,-0.3227437734603882,-1.0318207740783691,-0.13371442258358002,1.7268919944763184,-0.11198239028453827,0.40268558263778687,0.4756212830543518,-0.4211973547935486,-0.5117138624191284,0.18343107402324677,0.18368881940841675,0.6944949626922607,-0.16899597644805908,-0.5365338921546936,-0.4515672028064728,-0.2976466715335846,1.1089280843734741,0.054930467158555984,-1.2073659896850586,0.3766246736049652,-0.41592374444007874,-0.5418676733970642,0.884134829044342,1.4805588722229004,0.2839145064353943,0.7610609531402588,-0.71871018409729,0.14898361265659332,-0.7622259259223938,-0.11365338414907455,0.6295951008796692,0.16535377502441406,0.030682552605867386,-0.7951509356498718,0.05858853831887245,-0.07568645477294922,0.6381638646125793,-0.026956435292959213,0.38240841031074524,0.32642191648483276,-0.6304534077644348,-0.07268206030130386,0.9231394529342651,0.2524695098400116,0.07015359401702881,0.5886672735214233,0.9605169892311096,0.2776367664337158,-0.17291341722011566,0.8662722706794739,-0.1923740655183792,0.8973575830459595,0.3554554581642151,-0.11009088903665543,0.3345150351524353,-0.7008129358291626,0.11430735886096954,-0.7062004804611206,-1.5481195449829102,0.6557520031929016,1.3195738792419434,-0.5628209114074707,0.8484976887702942,0.5588016510009766,0.39445191621780396,-0.2563537061214447,-0.25039276480674744,-0.2567713260650635,0.11877194046974182,-0.27637094259262085,0.7097644209861755,-1.5801671743392944,1.2293463945388794,1.2484586238861084,0.53751540184021,-0.17467595636844635,1.2030586004257202,0.5422540903091431,-1.4397306442260742,0.8404576182365417,1.3253710269927979,1.2416162490844727,-0.9465186595916748,-0.8654986023902893,-1.8616877794265747,-0.8671916127204895,-1.0245192050933838,-0.2296239137649536,-1.138808250427246,-1.1471129655838013,0.03665974736213684,-0.13439476490020752,-0.40301746129989624,-1.0247728824615479,0.6690802574157715,0.24704806506633759,-0.90038001537323,-1.4512461423873901,0.1422826647758484,-0.6281734108924866,-0.3091941177845001,-1.2672154903411865,-0.36558112502098083,-1.1715483665466309,-0.3569914996623993,-0.9872918128967285,-0.05873408913612366,0.04868693649768829,-0.6138096451759338,0.8545282483100891,0.17513658106327057,0.44365543127059937,-0.08012013882398605,1.2871081829071045,-0.9565568566322327,1.1192240715026855,0.7780447602272034,-0.4043738543987274,0.5689440965652466,0.7629563212394714,0.9659018516540527,0.0965898185968399,-0.48897355794906616,-0.7067203521728516,-0.930230438709259,0.21608006954193115,1.2069060802459717,-0.40541893243789673,0.2631010413169861,-1.6209526062011719,0.7758709788322449,-0.9011887907981873,0.08151715993881226,0.41909268498420715,-0.37639379501342773,-0.5431812405586243,1.5611516237258911,0.3943661153316498,-0.17786356806755066,0.07503627240657806,0.7653921842575073,1.203494906425476,-1.431505799293518,0.6060589551925659,1.394439697265625,-0.5352548360824585,0.11528728157281876,0.25294455885887146,-0.7034850716590881,0.3007485568523407,1.0459363460540771,0.09040917456150055,0.11875607073307037,-0.31019076704978943,0.3508666753768921,-0.18950140476226807,-0.5662515759468079,0.31127026677131653,0.121575266122818,0.3259488046169281,0.8567917346954346,0.9187315106391907,-1.3130382299423218,-0.25039738416671753,-0.31754183769226074,1.3004655838012695,0.5466935634613037,-0.8661260008811951,-0.8597999811172485,0.5610145926475525,0.7991248369216919,0.8396620750427246,0.2443923056125641,0.6129994988441467,0.6802970170974731,-1.3687175512313843,-0.9844191670417786,0.05043524131178856,0.05744028836488724,0.10736347734928131,0.2901414632797241,-0.1577167809009552,-1.586607813835144,-0.7893494963645935,-1.7084357738494873,0.4529586434364319,1.6553781032562256,-1.451203465461731,-0.9065855741500854,-0.22162672877311707,-1.040097951889038,0.8971824645996094,-0.01422133855521679,-0.05220777168869972,-0.25094836950302124,0.35284924507141113,-0.061162061989307404,0.6197977662086487,-0.5413172245025635,0.22652681171894073,1.4785583019256592,-0.8836309313774109,0.02230454981327057,-0.885473906993866,0.8625439405441284,1.1030508279800415,0.029705414548516273,-0.15895619988441467,0.15473216772079468,-0.7686017155647278,1.9408766031265259,-0.7384557127952576,-0.7252610325813293,0.354630708694458,1.0389925241470337,1.1399314403533936,-0.16651378571987152,-1.021203875541687,1.7808067798614502,-0.16861383616924286,-1.2993988990783691,0.2423601895570755,-0.5595793724060059,0.16776591539382935,-0.6613547205924988,-0.7267058491706848,1.1272722482681274,-0.7599002122879028,-0.34759145975112915,-0.45293307304382324,-1.2821989059448242,0.41810762882232666,-0.4922829568386078,-0.7145037651062012,-0.29780450463294983,-1.4277284145355225,0.11130396276712418,-0.5713990926742554,-0.4996052384376526,-0.5271884202957153,-0.7872965931892395,0.493461012840271,-0.01290832832455635,-0.7010326981544495,-0.30406129360198975,-1.4737383127212524,1.0085437297821045,-0.5675026774406433,1.5353480577468872,-0.025257863104343414,-0.04387223720550537,0.10455272346735,-0.9053795337677002,-1.9890192747116089,0.5213227868080139,-1.4234890937805176,0.07291601598262787,2.055255651473999,-1.5626671314239502,-0.3215144872665405,-0.6023209095001221,0.3069188892841339,0.2663697600364685,-0.3603416681289673,0.262163370847702,-0.5401115417480469,-0.5192789435386658,0.04744672775268555,0.805069088935852,-0.7534106969833374,0.7367245554924011,0.8898062705993652,-1.301872968673706,0.06554558128118515,-1.2720991373062134,0.9689207673072815,0.4632719159126282,0.5430521965026855,0.41047045588493347,-0.49970054626464844,1.0791460275650024,-0.08268564194440842,0.08244488388299942,0.8874704241752625,-0.5848349332809448,0.6092207431793213,-0.584730863571167,0.9769432544708252,0.4948141574859619,0.6137620806694031,-0.5237360596656799,0.6365835070610046,0.42272621393203735,-0.6540102958679199,-1.0973305702209473,-0.7654449939727783,-1.2062667608261108,-0.7644525170326233,-1.3098026514053345,-0.1309853047132492,-0.9762336015701294,0.9817970991134644,-0.7695013880729675,0.7270160913467407,-1.250623106956482,-0.1354728639125824,-0.48667022585868835,1.6694897413253784,-0.4766148030757904,0.43355193734169006,-0.24986900389194489,-1.8112328052520752,-0.31937816739082336,-1.3028813600540161,-0.8237623572349548,0.9663758873939514,0.02225007861852646,0.2070610374212265,-0.6952317357063293,-0.27587541937828064,0.9721131920814514,-1.1008391380310059,0.6992543339729309,0.022008653730154037,0.05403594672679901,-0.18532666563987732,0.7001239061355591,0.6450116038322449,-0.025888005271553993,-0.5109444260597229,1.2263541221618652,0.494925320148468,-0.8494971394538879,-0.46202483773231506,-0.15266132354736328,0.2861839830875397,0.05700726807117462,-1.3705084323883057,0.11772262305021286,1.2643884420394897,-1.284153938293457,-0.004649741109460592,-0.8279439210891724,1.4733060598373413,-0.05634833127260208,0.01048293523490429,1.0468411445617676,0.07096542418003082,-0.21669751405715942,-0.6444077491760254,0.4643281400203705,-0.7237762808799744,-0.532537043094635,0.780707061290741,-0.2653196156024933,0.4693034887313843,0.5093371272087097,1.0849807262420654,0.7649630308151245,0.15126867592334747,-1.6931884288787842,0.3894840478897095,-0.39991289377212524,0.6047192811965942,-1.324873447418213,-0.733915388584137,-0.4009692370891571,-0.6746657490730286,-0.13296379148960114,0.5309241414070129,-1.1659952402114868,-1.4484062194824219,-0.10902784764766693,0.6500044465065002,0.31735920906066895,0.4783566892147064,0.5014258623123169,-0.5301701426506042,0.9921095967292786,0.9894049763679504,-0.14855952560901642,-1.0183923244476318,0.9616231322288513,0.4147278964519501,-0.5845862627029419,0.1282252073287964,-0.24020880460739136,1.7025119066238403,-0.6806209087371826,-1.0668846368789673,-1.000368595123291,1.1320714950561523,-0.060832682996988297,0.3721720278263092,-0.8011694550514221,-0.8820859789848328,-0.2023092657327652,-0.5514101982116699,-1.6665621995925903,-0.352047324180603,-0.25240784883499146,-0.009951417334377766,-0.6120818257331848,0.09650486707687378,-0.5009612441062927,0.7146691083908081,0.460327684879303,-0.36410200595855713,0.3175397515296936,0.8832009434700012,0.2086566686630249,-1.5820118188858032,0.014253389090299606,-0.04749268665909767,0.010593411512672901,0.24087770283222198,-0.8782733082771301,0.3985579013824463,1.1985375881195068,-0.8951922655105591,-0.8041239976882935,-0.8852896690368652,-1.1668719053268433,0.850731372833252,1.2827363014221191,-0.2782668173313141,-0.3627948462963104,1.8161760568618774,0.2401154786348343,-0.26068785786628723,0.07221291959285736,-0.717430591583252,0.022454120218753815,1.3950084447860718,-1.6691404581069946,1.1116914749145508,1.1812403202056885,-0.17620211839675903,0.46783247590065,-0.1100086122751236,0.9395059943199158,-0.16605377197265625,-0.335946261882782,-0.46548303961753845,-0.3038228750228882,-0.1507725566625595,-1.1075170040130615,-0.4106716513633728,0.7702099084854126,-3.706183910369873,-0.3128882348537445,0.9669821858406067,0.59576815366745,-0.6629610657691956,0.5197736024856567,-0.7640101313591003,0.6511900424957275,-0.5962151288986206,-0.12117325514554977,1.0297181606292725,0.47360628843307495,0.36107712984085083,-1.689426064491272,-0.27991390228271484,0.21067169308662415,-0.525363028049469,0.5755065083503723,-0.8720439672470093,-0.08524379134178162,-0.3200356066226959,-0.807159423828125,-2.1990182399749756,-0.0068369763903319836,0.8851393461227417,0.19127364456653595,-1.209159255027771,-0.6497328877449036,0.980606198310852,-1.1299021244049072,-0.7423098683357239,0.8331586718559265,0.31807655096054077,0.28842082619667053,-1.8812096118927002,-0.044891614466905594,0.5198937654495239,0.5469721555709839,-0.5541674494743347,-0.46749719977378845,-0.0465184785425663,0.5439477562904358,1.0745786428451538,-0.16747529804706573,0.28054749965667725,-0.9788504242897034,-0.40175002813339233,-0.09315676242113113,0.6542916893959045,0.6603173017501831,-0.7147567272186279,-1.5799449682235718,-0.39851194620132446,0.03976232558488846,1.402539610862732,-0.05415809154510498,0.6279854774475098,0.7648351788520813,-0.7877062559127808,-0.021523043513298035,-0.6071772575378418,0.5715386271476746,-0.5108101963996887,-0.7496352195739746,0.2614608407020569,1.6559624671936035,0.29691067337989807,-0.3971744775772095,0.5833315849304199,-1.0150049924850464,-1.3995039463043213,-1.9135076999664307,0.49123483896255493,-1.1171858310699463,0.70854252576828,0.11140593886375427,-0.37355440855026245,-0.8252665996551514,0.028119785711169243,0.10379332304000854,-0.32226863503456116,0.7172132134437561,-0.08710425347089767,0.06101515144109726,-1.3878633975982666,0.5368870496749878,1.7451767921447754,0.01392664760351181,-1.6231050491333008,-0.3639374375343323,-0.5156763195991516,-0.12963807582855225,0.4013865292072296,-0.8111954927444458,0.16014300286769867,-0.41655802726745605,1.8432554006576538,-0.24028022587299347,-0.06487700343132019,-0.5434943437576294,-0.49104341864585876,0.13489775359630585,0.2786373794078827,0.04600977897644043,-0.1489664912223816,0.09390126168727875,0.04166211187839508,-0.13369672000408173,0.22868278622627258,0.08766553550958633,-0.6143498420715332,0.10117711126804352,-0.3939443826675415,0.6050925254821777,0.3411615788936615,-2.171823501586914,0.6335474848747253,-0.6364346742630005,-0.8641907572746277,0.4620929956436157,0.9479889869689941,0.37427714467048645,-0.5474539995193481,0.34368836879730225,-0.2053793966770172,0.27864083647727966,0.03294701874256134,-0.5909634828567505,-0.16572509706020355,-0.6705855131149292,0.2389247566461563,0.49959591031074524,0.1626969277858734,-0.8103654980659485,-0.006582989357411861,-0.09455558657646179,0.24103623628616333,0.6023674011230469,-0.8330481648445129,1.2904551029205322,-0.9012040495872498,-0.046505156904459,-0.33953413367271423,0.526981770992279,-1.0946016311645508,-1.0239646434783936,-0.353890061378479,0.15577876567840576,1.1832834482192993,0.4780409336090088,0.2734007239341736,-0.7242938280105591,-0.11982254683971405,1.7584638595581055,-0.4795297086238861,0.024623151868581772,0.025621185079216957,-0.06832253187894821,-0.6012810468673706,-0.21099311113357544,-0.32586538791656494,-0.10182658582925797,-0.2321944534778595,0.39840593934059143,1.5247831344604492,-1.3404150009155273,0.29830074310302734,0.18393395841121674,-0.6725356578826904,0.5454506874084473,0.721590518951416,-0.4938533902168274,-0.7074030041694641,-0.9005465507507324,-0.7303938865661621,0.6391989588737488,-0.9403316974639893,0.6858043670654297,0.6104618310928345,1.319220781326294,1.106472134590149,-0.6744827628135681,0.9393790364265442,0.02276734448969364,1.8503872156143188,1.0790331363677979,-0.03205626457929611,-1.2056282758712769,1.103559136390686,0.16838769614696503,-1.734511375427246,0.9553629755973816,0.018945006653666496,-0.006772418972104788,-0.6319678425788879,0.3762008845806122,1.23843514919281,-1.0681205987930298,-0.1042703241109848,0.38402342796325684,-0.914002001285553,0.06559060513973236,0.4073858857154846,-0.4264442026615143,-0.22224019467830658,-0.5977283716201782,-0.27013635635375977,-0.5372498035430908,-0.2635926306247711,-0.9010112285614014,0.6663375496864319,0.6098305583000183,-0.2301083505153656,0.2382669448852539,0.4886043965816498,0.7450243830680847,-0.1451471894979477,-1.2277946472167969,-0.3807026147842407,-0.3988496661186218,-0.0888884961605072,0.7527939677238464,-0.8827897310256958,-0.381509929895401,1.3252463340759277,-1.066478967666626,1.3702733516693115,-0.08114656060934067,-0.4389698803424835,0.2997888922691345,-0.4132974147796631,-0.1355491727590561,1.253552794456482,0.552354633808136,-0.2736983895301819,0.7369334101676941,0.26960188150405884,-0.6629267334938049,-0.2541397511959076,1.0024679899215698,-0.10224290192127228,-0.223319873213768,-0.26836255192756653,-0.3072875738143921,0.6338555216789246,-0.11916349828243256,0.5918476581573486,0.3732667863368988,-0.6621313691139221,1.1255085468292236,-1.3654794692993164,-1.3266119956970215,-0.1849021017551422,0.3006529211997986,-0.34432342648506165,-0.37980955839157104,-1.4683040380477905,-0.5083650946617126,0.8866968750953674,0.6195753812789917,-0.6079313158988953,0.5898827314376831,-0.7034536600112915,0.5089744925498962,-1.577544093132019,-0.7519906163215637,0.4265071749687195,1.6217509508132935,-0.9906885027885437,0.7175781726837158,-0.5143117904663086,0.17766031622886658,0.5247570872306824,0.2694171667098999,-0.46314534544944763,-0.5129293203353882,0.2962534427642822,0.6442275643348694,-0.15496015548706055,-0.5980215668678284] AS float4[]
            )
        ) AS distance
FROM dolphin_embedding_algo.XXX_kgb_cmop_p4p_cmop_n_nopass_knowledges_embedding_knlg_data
ORDER BY distance ASC 
LIMIT 1;"""
    print(execute_dolphin_model_sql(sql))